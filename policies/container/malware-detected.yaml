id: container-014
name: Container images should not contain malware
description: |
  Container images must be free of malware, cryptominers, and other
  malicious software. Malware in images can compromise infrastructure
  and lead to data theft or resource abuse.

enabled: true
severity: critical

resource_type: container_image

check:
  type: expression
  expression: "resource.malware_detected == false"

compliance:
  - framework: nist-800-53
    version: "5.0"
    control: "SI-3"
  - framework: cis-docker
    version: "1.6.0"
    control: "4.4"
  - framework: pci-dss
    version: "4.0"
    control: "5.2"

remediation:
  guidance: |
    1. Quarantine the affected image immediately
    2. Investigate source of malware
    3. Check build pipeline for compromise
    4. Scan base images and dependencies
    5. Rebuild image from trusted sources
    6. Scan all related images for infection
    7. Report incident per security policies
  automation_supported: false

tags:
  - container
  - image-security
  - malware
  - cryptominer
  - threat

references:
  - https://aquasecurity.github.io/trivy/
