id: aws-bedrock-001
name: Bedrock guardrail configured for content filtering
description: |
  Ensure Bedrock guardrails are configured with content filtering.
  Guardrails help prevent harmful, inappropriate, or sensitive
  content from being generated by foundation models.

enabled: true
severity: high

resource_type: aws_bedrock_guardrail

check:
  type: expression
  expression: "resource.content_policy != null or resource.word_policy != null or resource.sensitive_info_policy != null"

compliance:
  - framework: nist-800-53
    version: "rev5"
    control: "SI-10"
  - framework: soc2
    version: "2017"
    control: "CC7.2"
  - framework: nist-ai-rmf
    version: "1.0"
    control: "GOVERN 1.1"

remediation:
  guidance: |
    To configure Bedrock guardrails:
    1. Create a guardrail in the Bedrock console:
       - Navigate to Guardrails section
       - Choose Create guardrail
       - Configure content filters:
         - Hate speech filtering
         - Violence filtering
         - Sexual content filtering
         - Profanity filtering
    2. Add word policies for custom blocked terms
    3. Configure sensitive information policies:
       - PII detection and masking
       - Custom regex patterns
    4. Associate guardrail with model invocations
  automation_supported: false

tags:
  - bedrock
  - guardrail
  - content-filtering
  - ai-safety
  - ai-ml

references:
  - https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails.html
  - https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-content-filters.html
