id: aws-s3-001
name: S3 bucket encryption enabled
description: |
  Ensure S3 buckets have server-side encryption enabled.
  Server-side encryption protects data at rest.

enabled: true
severity: high

resource_type: aws_s3_bucket

check:
  type: expression
  expression: "resource.encryption.enabled == true"

benchmark:
  - cis-aws: "2.1.1"

remediation:
  guidance: |
    1. Open the Amazon S3 console
    2. Select the bucket
    3. Choose the Properties tab
    4. Under Default encryption, choose Edit
    5. Select Enable server-side encryption
    6. Choose encryption type (SSE-S3 or SSE-KMS)
    7. Save changes
  automation_supported: false

tags:
  - s3
  - encryption
  - storage
  - data-protection

references:
  - https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html
