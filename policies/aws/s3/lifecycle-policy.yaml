id: aws-s3-008
name: S3 bucket has lifecycle policy
description: |
  Ensure S3 buckets have lifecycle policies configured. Lifecycle policies
  automate transitioning objects to cheaper storage classes and expiring
  old data, optimizing costs and ensuring data retention compliance.

enabled: true
severity: low

resource_type: aws_s3_bucket

check:
  type: expression
  expression: "resource.lifecycle_rules_count >= 1"

compliance:
  - framework: nist-800-53
    version: "rev5"
    control: "AU-11"
  - framework: pci-dss
    version: "4.0"
    control: "9.5.1"

remediation:
  guidance: |
    1. Open the Amazon S3 console
    2. Select the bucket
    3. Choose the Management tab
    4. Under Lifecycle rules, click Create lifecycle rule
    5. Configure rule:
       - Name the rule
       - Apply to all objects or filter by prefix/tags
       - Add transitions (to Standard-IA, Glacier, etc.)
       - Add expiration for old versions or delete markers
    6. Save rule

    Example: Transition to Glacier after 90 days,
    expire noncurrent versions after 365 days.
  automation_supported: false

tags:
  - s3
  - lifecycle
  - storage
  - cost-optimization
  - retention

references:
  - https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lifecycle-mgmt.html
