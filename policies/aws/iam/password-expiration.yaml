id: aws-iam-010
name: Password expiration enabled
description: |
  Ensure the IAM password policy enforces password expiration. While
  NIST guidance has evolved on forced rotation, many compliance
  frameworks still require periodic password changes. Consider your
  organization's requirements when enabling this policy.

enabled: true
severity: low

resource_type: aws_iam_account_password_policy

check:
  type: expression
  expression: |
    resource.expire_passwords == true and
    resource.max_password_age exists and
    resource.max_password_age <= 90

compliance:
  - framework: cis-aws-foundations
    version: "1.5.0"
    control: "1.11"
  - framework: pci-dss
    version: "4.0"
    control: "8.3.9"

remediation:
  guidance: |
    1. Sign in to the AWS Console
    2. Navigate to IAM > Account settings
    3. Click "Change password policy"
    4. Enable "Enable password expiration"
    5. Set "Password expiration period" to 90 days or less
    6. Click "Save changes"

    Note: Modern security guidance (NIST SP 800-63B) suggests not
    requiring periodic password changes unless there's evidence of
    compromise. Consider using MFA and monitoring for compromised
    credentials instead of forced rotation.
  automation_supported: false

tags:
  - iam
  - password-policy
  - credential-management
  - compliance

references:
  - https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html
  - https://pages.nist.gov/800-63-3/sp800-63b.html
