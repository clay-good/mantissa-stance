id: aws-iam-009
name: Password reuse prevention enabled
description: |
  Ensure the IAM password policy prevents password reuse. Allowing
  users to reuse recent passwords increases the risk of compromised
  credentials being reused. AWS allows preventing reuse of the last
  1 to 24 passwords.

enabled: true
severity: medium

resource_type: aws_iam_account_password_policy

check:
  type: expression
  expression: |
    resource.password_reuse_prevention exists and
    resource.password_reuse_prevention >= 12

compliance:
  - framework: cis-aws-foundations
    version: "1.5.0"
    control: "1.12"
  - framework: pci-dss
    version: "4.0"
    control: "8.3.7"
  - framework: nist-800-53
    version: "rev5"
    control: "IA-5(1)"

remediation:
  guidance: |
    1. Sign in to the AWS Console
    2. Navigate to IAM > Account settings
    3. Click "Change password policy"
    4. Enable "Prevent password reuse"
    5. Set "Number of passwords to remember" to at least 12
    6. Click "Save changes"
  automation_supported: false

tags:
  - iam
  - password-policy
  - credential-management
  - access-control

references:
  - https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html
