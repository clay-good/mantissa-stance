id: k8s-wl-002
name: Deployments should use RollingUpdate strategy
description: |
  The RollingUpdate strategy ensures zero-downtime deployments by
  gradually replacing old pods with new ones. Recreate strategy
  causes downtime as all pods are terminated before new ones start.

enabled: true
severity: low

resource_type: k8s_deployment

check:
  type: expression
  expression: "resource.strategy_type == 'RollingUpdate'"

compliance:
  - framework: nist-800-53
    version: "5.0"
    control: "CP-10"

remediation:
  guidance: |
    1. Review the deployment specification
    2. Set the strategy type to RollingUpdate:
       spec:
         strategy:
           type: RollingUpdate
           rollingUpdate:
             maxSurge: 25%
             maxUnavailable: 25%
    3. Configure appropriate maxSurge and maxUnavailable values
    4. Ensure readiness probes are configured for proper rollouts
  automation_supported: true

tags:
  - kubernetes
  - deployment
  - rolling-update
  - zero-downtime
  - availability

references:
  - https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#strategy
