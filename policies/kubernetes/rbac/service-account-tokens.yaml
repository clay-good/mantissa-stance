id: k8s-rbac-005
name: Service account token auto-mount should be disabled
description: |
  Automatically mounting service account tokens in pods gives
  all containers access to the Kubernetes API. This should
  be disabled unless the pod needs to interact with the API.

enabled: true
severity: medium

resource_type: k8s_service_account

check:
  type: expression
  expression: "resource.automount_service_account_token == False"

compliance:
  - framework: cis-kubernetes
    version: "1.8.0"
    control: "5.1.6"
  - framework: nist-800-53
    version: "5.0"
    control: "AC-6"

remediation:
  guidance: |
    1. Review the service account
    2. Set automountServiceAccountToken: false
    3. For pods that need API access, explicitly set it
    4. Use workload identity where available
    5. Apply the updated service account
  automation_supported: false

tags:
  - kubernetes
  - rbac
  - service-account
  - token-mount
  - least-privilege

references:
  - https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
