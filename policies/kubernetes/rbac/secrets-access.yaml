id: k8s-rbac-003
name: Roles with secrets access should be limited
description: |
  Access to secrets allows reading sensitive information like
  passwords, API keys, and certificates. Roles with secrets
  access should be carefully reviewed and limited.

enabled: true
severity: high

resource_type: k8s_cluster_role

check:
  type: expression
  expression: "resource.risk_analysis.has_secrets_access == false"

compliance:
  - framework: cis-kubernetes
    version: "1.8.0"
    control: "5.1.2"
  - framework: nist-800-53
    version: "5.0"
    control: "AC-6"
  - framework: pci-dss
    version: "4.0"
    control: "3.4"

remediation:
  guidance: |
    1. Review the role definition
    2. Identify rules granting secrets access
    3. Evaluate if secrets access is necessary
    4. Use external secrets management if possible
    5. Limit secrets access to specific namespaces
    6. Audit secrets access regularly
  automation_supported: false

tags:
  - kubernetes
  - rbac
  - secrets
  - sensitive-data
  - access-control

references:
  - https://kubernetes.io/docs/concepts/configuration/secret/
