id: k8s-rbac-006
name: Default service account should not be used for workloads
description: |
  The default service account in each namespace should not be
  used for application workloads. Create dedicated service
  accounts with minimal permissions instead.

enabled: true
severity: medium

resource_type: k8s_pod

check:
  type: expression
  expression: "resource.service_account != 'default'"

compliance:
  - framework: cis-kubernetes
    version: "1.8.0"
    control: "5.1.5"
  - framework: nist-800-53
    version: "5.0"
    control: "AC-6"

remediation:
  guidance: |
    1. Create a dedicated service account for the workload
    2. Grant only required permissions to the service account
    3. Update the pod spec to use the new service account
    4. Disable token automount if API access is not needed
    5. Apply the updated configuration
  automation_supported: false

tags:
  - kubernetes
  - rbac
  - service-account
  - default-account
  - workload-identity

references:
  - https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
