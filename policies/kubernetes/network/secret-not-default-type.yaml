id: k8s-net-008
name: Secrets should use appropriate secret types
description: |
  Kubernetes secrets should use the correct type for their content.
  Using Opaque type for TLS certificates or Docker configs may indicate
  misconfiguration or bypass of built-in validation.

enabled: true
severity: low

resource_type: k8s_secret

check:
  type: expression
  expression: "resource.uses_appropriate_type == true"

compliance:
  - framework: nist-800-53
    version: "5.0"
    control: "CM-6"

remediation:
  guidance: |
    1. Review the secret content and determine the correct type:
       - kubernetes.io/tls for TLS certificates
       - kubernetes.io/dockerconfigjson for Docker registry credentials
       - kubernetes.io/basic-auth for basic authentication
       - kubernetes.io/ssh-auth for SSH credentials
    2. Recreate the secret with the appropriate type:
       kubectl create secret tls my-tls-secret \
         --cert=path/to/tls.crt \
         --key=path/to/tls.key
    3. Update workloads to reference the new secret
    4. Delete the old improperly typed secret
  automation_supported: true

tags:
  - kubernetes
  - secrets
  - configuration
  - secret-management
  - best-practices

references:
  - https://kubernetes.io/docs/concepts/configuration/secret/#secret-types
