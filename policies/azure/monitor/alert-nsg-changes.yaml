id: azure-monitor-006
name: Alert for Network Security Group changes
description: |
  Ensure an alert exists for creating, updating, or deleting Network Security
  Groups and their rules. NSG changes can expose resources to unauthorized
  network access and should be monitored.

enabled: true
severity: high

resource_type: azure_monitor_alert_rule

check:
  type: expression
  expression: "resource.alert_for_nsg_changes_exists == true"

compliance:
  - framework: cis-azure-foundations
    version: "2.0.0"
    control: "5.2.2"
  - framework: pci-dss
    version: "4.0"
    control: "10.2.7"
  - framework: nist-800-53
    version: "rev5"
    control: "AU-6"

remediation:
  guidance: |
    1. Navigate to Azure Monitor > Alerts
    2. Click Create > Alert rule
    3. Select subscription as target
    4. Configure condition:
       - Signal type: Activity Log
       - Category: Administrative
       - Resource type: Network security groups
       - Operations: Create/Update/Delete
    5. Configure action group for notifications
    6. Set alert rule name and severity (High)
    7. Create alert rule
  automation_supported: false

tags:
  - monitor
  - alerting
  - nsg
  - network
  - change-detection

references:
  - https://docs.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-activity-log
