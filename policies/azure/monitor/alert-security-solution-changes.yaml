id: azure-monitor-007
name: Alert for Security Solution changes
description: |
  Ensure an alert exists for creating, updating, or deleting Security Solutions.
  Security Solutions include Azure Defender, Sentinel, and third-party security
  tools. Changes should be monitored to prevent security gaps.

enabled: true
severity: critical

resource_type: azure_monitor_alert_rule

check:
  type: expression
  expression: "resource.alert_for_security_solution_changes_exists == true"

compliance:
  - framework: cis-azure-foundations
    version: "2.0.0"
    control: "5.2.3"
  - framework: pci-dss
    version: "4.0"
    control: "10.2.6"
  - framework: nist-800-53
    version: "rev5"
    control: "AU-6"

remediation:
  guidance: |
    1. Navigate to Azure Monitor > Alerts
    2. Click Create > Alert rule
    3. Select subscription as target
    4. Configure condition:
       - Signal type: Activity Log
       - Category: Security
       - Resource type: Security solutions
       - Operations: Create/Update/Delete
    5. Configure action group with immediate notification
    6. Set alert rule name and severity (Critical)
    7. Create alert rule
  automation_supported: false

tags:
  - monitor
  - alerting
  - security
  - defender
  - change-detection

references:
  - https://docs.microsoft.com/en-us/azure/security-center/security-center-alerts-overview
