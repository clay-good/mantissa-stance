id: azure-sql-007
name: Azure SQL minimum TLS version 1.2
description: |
  Ensure Azure SQL Server enforces TLS 1.2 as the minimum version.
  TLS 1.0 and 1.1 have known vulnerabilities and should not be used
  for database connections.

enabled: true
severity: high

resource_type: azure_sql_server

check:
  type: expression
  expression: "resource.minimal_tls_version == '1.2'"

compliance:
  - framework: cis-azure-foundations
    version: "2.0.0"
    control: "4.1.3"
  - framework: pci-dss
    version: "4.0"
    control: "4.2.1"
  - framework: nist-800-53
    version: "rev5"
    control: "SC-8"

remediation:
  guidance: |
    1. Navigate to SQL Server in Azure Portal
    2. Under Security, select Networking
    3. Under TLS version:
       - Set "Minimum TLS version" to 1.2
    4. Save changes

    Note: Verify that all client applications support TLS 1.2
    before making this change.
  automation_supported: false

tags:
  - sql
  - azure-sql
  - tls
  - encryption
  - database

references:
  - https://docs.microsoft.com/en-us/azure/azure-sql/database/connectivity-settings
