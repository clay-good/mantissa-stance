id: azure-sql-008
name: Azure SQL vulnerability assessment enabled
description: |
  Ensure vulnerability assessment is enabled for Azure SQL databases.
  Vulnerability assessment scans databases for security issues and
  provides actionable remediation guidance.

enabled: true
severity: medium

resource_type: azure_sql_server

check:
  type: expression
  expression: "resource.vulnerability_assessment_enabled == true"

compliance:
  - framework: cis-azure-foundations
    version: "2.0.0"
    control: "4.2.2"
  - framework: pci-dss
    version: "4.0"
    control: "11.3"
  - framework: nist-800-53
    version: "rev5"
    control: "RA-5"

remediation:
  guidance: |
    1. Navigate to SQL Server in Azure Portal
    2. Under Security, select Microsoft Defender for Cloud
    3. Enable "Microsoft Defender for SQL"
    4. Configure Vulnerability Assessment:
       - Select storage account for scan results
       - Enable periodic recurring scans
       - Configure email notifications
    5. Save configuration
  automation_supported: false

tags:
  - sql
  - azure-sql
  - vulnerability
  - assessment
  - database

references:
  - https://docs.microsoft.com/en-us/azure/azure-sql/database/sql-vulnerability-assessment
