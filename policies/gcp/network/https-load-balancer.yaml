id: gcp-network-002
name: Load balancer uses HTTPS frontend
description: |
  Ensure Google Cloud Load Balancers use HTTPS for frontend connections.
  HTTP traffic is unencrypted and vulnerable to interception. Use HTTPS
  with managed or custom certificates.

enabled: true
severity: high

resource_type: gcp_compute_url_map

check:
  type: expression
  expression: "resource.uses_https_frontend == true"

compliance:
  - framework: cis-gcp-foundations
    version: "1.3.0"
    control: "3.9"
  - framework: pci-dss
    version: "4.0"
    control: "4.2.1"
  - framework: nist-800-53
    version: "rev5"
    control: "SC-8"

remediation:
  guidance: |
    1. Navigate to Load Balancing in Console
    2. Select the load balancer
    3. Edit configuration
    4. In Frontend configuration:
       - Add HTTPS frontend
       - Select or create SSL certificate
       - Set minimum TLS version to 1.2
    5. Optionally configure HTTP to HTTPS redirect
    6. Save configuration
  automation_supported: false

tags:
  - network
  - https
  - load-balancer
  - encryption
  - ssl

references:
  - https://cloud.google.com/load-balancing/docs/https
