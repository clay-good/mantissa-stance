id: gcp-network-008
name: Firewall rules have logging enabled
description: |
  Ensure VPC firewall rules have logging enabled. Firewall logs capture
  allowed and denied connections for security monitoring, threat detection,
  and compliance auditing.

enabled: true
severity: medium

resource_type: gcp_compute_firewall

check:
  type: expression
  expression: "resource.log_config_enabled == true"

compliance:
  - framework: cis-gcp-foundations
    version: "1.3.0"
    control: "3.6"
  - framework: pci-dss
    version: "4.0"
    control: "10.2.1"
  - framework: nist-800-53
    version: "rev5"
    control: "AU-2"

remediation:
  guidance: |
    1. Navigate to VPC Network > Firewall
    2. Select the firewall rule
    3. Click Edit
    4. Under Logs:
       - Set to On
       - Select metadata: Include all
    5. Save changes

    Consider enabling logging for:
    - All deny rules (critical)
    - Allow rules for sensitive resources
    - Rules with 0.0.0.0/0 source

    Note: Logging increases costs. Enable selectively.
  automation_supported: false

tags:
  - network
  - firewall
  - logging
  - monitoring
  - security

references:
  - https://cloud.google.com/vpc/docs/firewall-rules-logging
