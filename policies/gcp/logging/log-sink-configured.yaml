id: gcp-logging-002
name: Log sink configured for long-term retention
description: |
  Ensure a log sink is configured to export logs to Cloud Storage, BigQuery,
  or Pub/Sub for long-term retention and analysis. Default log retention in
  Cloud Logging may not meet compliance requirements.

enabled: true
severity: medium

resource_type: gcp_logging_sink

check:
  type: expression
  expression: "resource.log_sink_configured == true"

compliance:
  - framework: cis-gcp-foundations
    version: "1.3.0"
    control: "2.2"
  - framework: pci-dss
    version: "4.0"
    control: "10.7"
  - framework: nist-800-53
    version: "rev5"
    control: "AU-11"

remediation:
  guidance: |
    1. Go to GCP Console > Logging > Log Router
    2. Click Create Sink
    3. Configure sink name and destination:
       - Cloud Storage bucket for archival
       - BigQuery dataset for analysis
       - Pub/Sub topic for real-time streaming
    4. Set inclusion/exclusion filters as needed
    5. Create the sink
    6. Grant necessary permissions to sink service account
  automation_supported: false

tags:
  - logging
  - log-sink
  - retention
  - compliance
  - export

references:
  - https://cloud.google.com/logging/docs/export
