id: gcp-sql-004
name: Cloud SQL automated backups enabled
description: |
  Ensure Cloud SQL instances have automated backups enabled. Automated
  backups provide point-in-time recovery capability and protect against
  data loss from accidental deletion or corruption.

enabled: true
severity: high

resource_type: gcp_cloudsql_instance

check:
  type: expression
  expression: "resource.backup_enabled == true"

compliance:
  - framework: cis-gcp-foundations
    version: "1.3.0"
    control: "6.7"
  - framework: pci-dss
    version: "4.0"
    control: "9.5.1"
  - framework: nist-800-53
    version: "rev5"
    control: "CP-9"

remediation:
  guidance: |
    1. Navigate to Cloud SQL in Google Cloud Console
    2. Select the instance
    3. Click Edit
    4. Under Backups:
       - Enable "Automated backups"
       - Set backup start time
       - Enable point-in-time recovery (recommended)
       - Set retention period (7-365 days)
    5. Save changes
  automation_supported: false

tags:
  - sql
  - cloudsql
  - backup
  - database
  - data-protection

references:
  - https://cloud.google.com/sql/docs/mysql/backup-recovery/backups
