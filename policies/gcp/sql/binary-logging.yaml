id: gcp-sql-005
name: Cloud SQL binary logging enabled for MySQL
description: |
  Ensure Cloud SQL MySQL instances have binary logging enabled.
  Binary logging is required for point-in-time recovery and replication.
  It captures all changes to the database for recovery purposes.

enabled: true
severity: medium

resource_type: gcp_cloudsql_instance

check:
  type: expression
  expression: "resource.binary_log_enabled == true or resource.database_version not_in ['MYSQL_5_6', 'MYSQL_5_7', 'MYSQL_8_0']"

compliance:
  - framework: cis-gcp-foundations
    version: "1.3.0"
    control: "6.7"
  - framework: nist-800-53
    version: "rev5"
    control: "CP-9"
  - framework: pci-dss
    version: "4.0"
    control: "9.5.1"

remediation:
  guidance: |
    1. Navigate to Cloud SQL in Google Cloud Console
    2. Select the MySQL instance
    3. Click Edit
    4. Under Backups:
       - Enable "Point-in-time recovery"
       - This automatically enables binary logging
    5. Save changes

    Note: Binary logging increases storage usage. Consider
    setting appropriate retention period.
  automation_supported: false

tags:
  - sql
  - cloudsql
  - mysql
  - binary-logging
  - recovery

references:
  - https://cloud.google.com/sql/docs/mysql/backup-recovery/pitr
