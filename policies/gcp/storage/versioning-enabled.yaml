id: gcp-storage-005
name: Cloud Storage bucket versioning enabled
description: |
  Ensure Cloud Storage buckets have object versioning enabled. Versioning
  protects against accidental deletions and overwrites by maintaining
  historical versions of objects.

enabled: true
severity: medium

resource_type: gcp_storage_bucket

check:
  type: expression
  expression: "resource.versioning_enabled == true"

compliance:
  - framework: cis-gcp-foundations
    version: "1.3.0"
    control: "5.2"
  - framework: pci-dss
    version: "4.0"
    control: "9.5.1"
  - framework: nist-800-53
    version: "rev5"
    control: "CP-9"

remediation:
  guidance: |
    1. Navigate to Cloud Storage in Console
    2. Select the bucket
    3. Go to Protection tab
    4. Under Object versioning:
       - Click Enable
    5. Configure lifecycle rules to manage versions:
       - Delete noncurrent versions after X days
       - Limit number of versions

    Using gsutil:
    gsutil versioning set on gs://BUCKET_NAME
  automation_supported: false

tags:
  - storage
  - versioning
  - gcs
  - data-protection
  - backup

references:
  - https://cloud.google.com/storage/docs/object-versioning
