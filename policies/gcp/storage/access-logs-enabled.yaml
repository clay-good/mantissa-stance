id: gcp-storage-010
name: Cloud Storage bucket access logs enabled
description: |
  Ensure Cloud Storage buckets have access logs enabled. Access logs
  capture detailed request information for security analysis, auditing,
  and troubleshooting.

enabled: true
severity: medium

resource_type: gcp_storage_bucket

check:
  type: expression
  expression: "resource.logging_enabled == true"

compliance:
  - framework: cis-gcp-foundations
    version: "1.3.0"
    control: "5.3"
  - framework: pci-dss
    version: "4.0"
    control: "10.2.1"
  - framework: nist-800-53
    version: "rev5"
    control: "AU-2"

remediation:
  guidance: |
    1. Create a destination bucket for logs
    2. Navigate to Cloud Storage in Console
    3. Select the source bucket
    4. Go to Configuration tab
    5. Under Cloud audit logging:
       - Already enabled via Cloud Audit Logs
    6. For usage logs (legacy):
       gsutil logging set on -b gs://LOG_BUCKET gs://SOURCE_BUCKET

    Recommended: Use Cloud Audit Logs for comprehensive
    logging via Admin Activity and Data Access logs.
  automation_supported: false

tags:
  - storage
  - logging
  - gcs
  - audit
  - monitoring

references:
  - https://cloud.google.com/storage/docs/access-logs
