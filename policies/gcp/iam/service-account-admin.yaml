id: gcp-iam-006
name: Service Account Admin role not overly assigned
description: |
  Ensure the Service Account Admin role is not broadly assigned.
  This role allows managing service accounts and their keys, which
  can lead to privilege escalation. Limit this role to designated
  administrators only.

enabled: true
severity: high

resource_type: gcp_project_iam_binding

check:
  type: expression
  expression: |
    resource.role != "roles/iam.serviceAccountAdmin" or
    resource.member_count <= 3

compliance:
  - framework: cis-gcp-foundations
    version: "2.0.0"
    control: "1.5"
  - framework: nist-800-53
    version: "rev5"
    control: "AC-6(7)"

remediation:
  guidance: |
    1. Navigate to IAM & Admin > IAM in GCP Console
    2. Filter for the Service Account Admin role
    3. Review all members with this role
    4. Remove the role from users who don't need it
    5. Consider using Service Account User role instead
       for users who only need to run workloads as service accounts
    6. Use conditional IAM bindings to limit scope
    7. Implement approval workflows for this role
  automation_supported: false

tags:
  - iam
  - service-account
  - privileged-access
  - admin-role
  - gcp

references:
  - https://cloud.google.com/iam/docs/understanding-roles#service-accounts-roles
  - https://cloud.google.com/iam/docs/granting-changing-revoking-access
