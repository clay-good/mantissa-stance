id: gcp-iam-001
name: Service account keys rotated within 90 days
description: |
  Ensure service account keys are rotated within 90 days. Long-lived keys
  increase the risk of unauthorized access if compromised. Regular rotation
  reduces the window of opportunity for attackers.

enabled: true
severity: medium

resource_type: gcp_service_account

check:
  type: expression
  expression: "resource.has_old_keys == false"

benchmark:
  - cis-gcp: "1.7"

remediation:
  guidance: |
    1. Navigate to IAM & Admin > Service Accounts in GCP Console
    2. Select the service account with old keys
    3. Go to the Keys tab
    4. Create a new key
    5. Update applications to use the new key
    6. Delete the old key after verifying new key works
    7. Consider using Workload Identity instead of keys where possible
  automation_supported: false

tags:
  - iam
  - service-account
  - key-rotation
  - credential-management
  - gcp

references:
  - https://cloud.google.com/iam/docs/best-practices-for-managing-service-account-keys
  - https://cloud.google.com/iam/docs/creating-managing-service-account-keys
